# Deployment Scripts for slova-sveltekit

This directory contains deployment scripts for the slova-sveltekit application.

## Files

- `server-setup.sh` - Initial server setup and configuration collection
- `deploy.sh` - Main deployment script
- `deploy.config.sh` - Default configuration template
- `deploy.config.local.sh` - Local configuration (generated by server-setup.sh)

## Usage

### 1. Initial Setup (Run once)

Run the server setup script to configure your deployment:

```bash
cd deployment
./server-setup.sh
```

This script will:
- Ask for server IP, username, app name, and deployment path
- Ask for database name, user, and password
- Ask for application configuration (port, timeouts, etc.)
- Test SSH connectivity
- Set up the remote server with all required software
- Create a PostgreSQL database and user
- Save all configuration to `deploy.config.local.sh`

### 2. Deployment

After the initial setup, you can deploy your application:

```bash
cd deployment
./deploy.sh [environment]
```

The deployment script will:
- Build the application locally
- Run tests
- Create a deployment package with database configuration
- Upload to the server
- Run database migrations
- Restart the application
- Perform health checks
- Rollback on failure

## Configuration

The `deploy.config.local.sh` file contains all your deployment configuration:

- Server connection details
- Database credentials
- Application settings
- Timeouts and backup settings

**Important**: Keep this file secure as it contains sensitive information like database passwords.

## Requirements

### Local Machine
- SSH key configured for server access
- bun installed
- git repository with your application

### Server
- Ubuntu/Debian-based system
- SSH access with sudo privileges
- The server setup script will install all required software

## Troubleshooting

### SSH Connection Issues
- Ensure your SSH key is added to the server's `~/.ssh/authorized_keys`
- Check that the server IP and username are correct
- Verify SSH key permissions (should be 600)

### Database Issues
- Check that PostgreSQL is running: `sudo systemctl status postgresql`
- Verify database credentials in the configuration file
- Check database connection from the application

### Application Issues
- Check PM2 logs: `pm2 logs slova-sveltekit`
- Verify the application is running: `pm2 list`
- Check nginx configuration if using a reverse proxy

## Security Notes

- The `deploy.config.local.sh` file contains sensitive information
- Keep it out of version control (add to .gitignore)
- Use strong database passwords
- Consider using environment variables for sensitive data in production 